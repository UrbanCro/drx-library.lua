-- D.R.X UI Library
-- Load from GitHub and create custom GUIs with save/load functionality
-- Usage: local Library = loadstring(game:HttpGet("YOUR_GITHUB_RAW_LINK"))()

local Library = {}

-- Services
local CoreGui = game:GetService("CoreGui")
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local HttpService = game:GetService("HttpService")

-- Remove old instance
if CoreGui:FindFirstChild("DRXGUI") then
    CoreGui:FindFirstChild("DRXGUI"):Destroy()
    wait(0.1)
end

-- Colors - Muted and clean
local Colors = {
    Background = Color3.fromRGB(18, 18, 22),
    Surface = Color3.fromRGB(25, 25, 30),
    Elevated = Color3.fromRGB(32, 32, 38),
    
    Primary = Color3.fromRGB(100, 100, 255),
    Success = Color3.fromRGB(34, 197, 94),
    Error = Color3.fromRGB(239, 68, 68),
    
    TextPrimary = Color3.fromRGB(255, 255, 255),
    TextSecondary = Color3.fromRGB(156, 163, 175),
    Border = Color3.fromRGB(45, 45, 52),
}

-- Helper functions
local function Corner(parent, radius)
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, radius or 12)
    corner.Parent = parent
    return corner
end

local function Tween(object, props, duration, style, direction)
    local tween = TweenService:Create(
        object,
        TweenInfo.new(duration or 0.3, style or Enum.EasingStyle.Quint, direction or Enum.EasingDirection.Out),
        props
    )
    tween:Play()
    return tween
end

-- Save/Load System
local SaveFolder = "DRX_Configs"
local SavedConfigs = {}

local function LoadSavedConfigs()
    if not isfolder then
        warn("Executor doesn't support file operations")
        return {}
    end
    
    if not isfolder(SaveFolder) then
        makefolder(SaveFolder)
    end
    
    local configs = {}
    local success, files = pcall(function()
        return listfiles(SaveFolder)
    end)
    
    if not success then
        warn("Failed to list files")
        return configs
    end
    
    for _, file in pairs(files) do
        local fileName = file:match("([^/\\]+)$"):gsub("%.txt$", "")
        table.insert(configs, fileName)
    end
    
    print("Loaded configs:", table.concat(configs, ", "))
    
    return configs
end

local function SaveConfig(name, data)
    if not writefile then
        warn("Executor doesn't support file operations")
        return false
    end
    
    if not isfolder(SaveFolder) then
        makefolder(SaveFolder)
    end
    
    local success, err = pcall(function()
        local jsonData = HttpService:JSONEncode(data)
        writefile(SaveFolder .. "/" .. name .. ".txt", jsonData)
    end)
    
    if not success then
        warn("Save error:", err)
    end
    
    return success
end

local function LoadConfig(name)
    if not readfile then
        warn("Executor doesn't support file operations")
        return nil
    end
    
    local success, data = pcall(function()
        return HttpService:JSONDecode(readfile(SaveFolder .. "/" .. name .. ".txt"))
    end)
    
    return success and data or nil
end

local function DeleteConfig(name)
    if not delfile then
        warn("Executor doesn't support file operations")
        return false
    end
    
    local success = pcall(function()
        delfile(SaveFolder .. "/" .. name .. ".txt")
    end)
    
    return success
end

-- Main Library Function
function Library:CreateWindow(title)
    local Window = {}
    Window.Tabs = {}
    Window.ConfigValues = {}
    
    -- Create ScreenGui
    local ScreenGui = Instance.new("ScreenGui")
    ScreenGui.Name = "DRXGUI"
    ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
    ScreenGui.ResetOnSpawn = false
    ScreenGui.IgnoreGuiInset = true
    ScreenGui.Parent = CoreGui
    
    -- Main Container
    local Main = Instance.new("Frame")
    Main.Name = "MainContainer"
    Main.AnchorPoint = Vector2.new(0.5, 0.5)
    Main.Position = UDim2.new(0.5, 0, 0.5, 0)
    Main.Size = UDim2.new(0, 650, 0, 450)
    Main.BackgroundColor3 = Colors.Background
    Main.BorderSizePixel = 0
    Main.Parent = ScreenGui
    Corner(Main, 12)
    
    local MainStroke = Instance.new("UIStroke")
    MainStroke.Color = Colors.Border
    MainStroke.Thickness = 1
    MainStroke.Parent = Main
    
    -- Top Bar
    local TopBar = Instance.new("Frame")
    TopBar.Name = "TopBar"
    TopBar.Size = UDim2.new(1, 0, 0, 50)
    TopBar.BackgroundColor3 = Colors.Surface
    TopBar.BorderSizePixel = 0
    TopBar.Parent = Main
    Corner(TopBar, 12)
    
    local TopCover = Instance.new("Frame")
    TopCover.Size = UDim2.new(1, 0, 0, 12)
    TopCover.Position = UDim2.new(0, 0, 1, -12)
    TopCover.BackgroundColor3 = Colors.Surface
    TopCover.BorderSizePixel = 0
    TopCover.Parent = TopBar
    
    local Title = Instance.new("TextLabel")
    Title.Size = UDim2.new(1, -40, 1, 0)
    Title.Position = UDim2.new(0, 20, 0, 0)
    Title.BackgroundTransparency = 1
    Title.Font = Enum.Font.GothamBold
    Title.Text = title or "D.R.X"
    Title.TextColor3 = Colors.TextPrimary
    Title.TextSize = 18
    Title.TextXAlignment = Enum.TextXAlignment.Left
    Title.Parent = TopBar
    
    -- Sidebar
    local Sidebar = Instance.new("Frame")
    Sidebar.Name = "Sidebar"
    Sidebar.Size = UDim2.new(0, 160, 1, -65)
    Sidebar.Position = UDim2.new(0, 12, 0, 60)
    Sidebar.BackgroundColor3 = Colors.Surface
    Sidebar.BorderSizePixel = 0
    Sidebar.Parent = Main
    Corner(Sidebar, 10)
    
    local TabList = Instance.new("UIListLayout")
    TabList.Padding = UDim.new(0, 6)
    TabList.SortOrder = Enum.SortOrder.LayoutOrder
    TabList.HorizontalAlignment = Enum.HorizontalAlignment.Center
    TabList.Parent = Sidebar
    
    local TabPadding = Instance.new("UIPadding")
    TabPadding.PaddingTop = UDim.new(0, 12)
    TabPadding.PaddingBottom = UDim.new(0, 12)
    TabPadding.Parent = Sidebar
    
    -- Content Area
    local ContentArea = Instance.new("Frame")
    ContentArea.Name = "ContentArea"
    ContentArea.Size = UDim2.new(1, -190, 1, -65)
    ContentArea.Position = UDim2.new(0, 182, 0, 60)
    ContentArea.BackgroundTransparency = 1
    ContentArea.BorderSizePixel = 0
    ContentArea.Parent = Main
    
    -- Tab system
    local CurrentTab = nil
    
    -- Element creators
    local function CreateButton(parent, text, callback)
        local Button = Instance.new("TextButton")
        Button.Size = UDim2.new(1, 0, 0, 38)
        Button.BackgroundColor3 = Colors.Elevated
        Button.BorderSizePixel = 0
        Button.Font = Enum.Font.Gotham
        Button.Text = text
        Button.TextColor3 = Colors.TextPrimary
        Button.TextSize = 13
        Button.AutoButtonColor = false
        Button.Parent = parent
        Corner(Button, 8)
        
        Button.MouseEnter:Connect(function()
            Tween(Button, {BackgroundColor3 = Colors.Primary}, 0.2)
        end)
        
        Button.MouseLeave:Connect(function()
            Tween(Button, {BackgroundColor3 = Colors.Elevated}, 0.2)
        end)
        
        Button.MouseButton1Click:Connect(function()
            if callback then pcall(callback) end
        end)
        
        return Button
    end
    
    local function CreateToggle(parent, text, default, callback)
        local Container = Instance.new("Frame")
        Container.Size = UDim2.new(1, 0, 0, 38)
        Container.BackgroundColor3 = Colors.Elevated
        Container.BorderSizePixel = 0
        Container.Parent = parent
        Corner(Container, 8)
        
        local Label = Instance.new("TextLabel")
        Label.Size = UDim2.new(1, -60, 1, 0)
        Label.Position = UDim2.new(0, 12, 0, 0)
        Label.BackgroundTransparency = 1
        Label.Font = Enum.Font.Gotham
        Label.Text = text
        Label.TextColor3 = Colors.TextPrimary
        Label.TextSize = 13
        Label.TextXAlignment = Enum.TextXAlignment.Left
        Label.Parent = Container
        
        local ToggleBack = Instance.new("Frame")
        ToggleBack.Size = UDim2.new(0, 42, 0, 22)
        ToggleBack.Position = UDim2.new(1, -50, 0.5, 0)
        ToggleBack.AnchorPoint = Vector2.new(0, 0.5)
        ToggleBack.BackgroundColor3 = default and Colors.Success or Colors.Surface
        ToggleBack.BorderSizePixel = 0
        ToggleBack.Parent = Container
        Corner(ToggleBack, 11)
        
        local ToggleKnob = Instance.new("Frame")
        ToggleKnob.Size = UDim2.new(0, 18, 0, 18)
        ToggleKnob.Position = default and UDim2.new(1, -20, 0.5, 0) or UDim2.new(0, 2, 0.5, 0)
        ToggleKnob.AnchorPoint = Vector2.new(0, 0.5)
        ToggleKnob.BackgroundColor3 = Colors.TextPrimary
        ToggleKnob.BorderSizePixel = 0
        ToggleKnob.Parent = ToggleBack
        Corner(ToggleKnob, 9)
        
        local state = default
        
        local ToggleButton = Instance.new("TextButton")
        ToggleButton.Size = UDim2.new(1, 0, 1, 0)
        ToggleButton.BackgroundTransparency = 1
        ToggleButton.Text = ""
        ToggleButton.Parent = ToggleBack
        
        ToggleButton.MouseButton1Click:Connect(function()
            state = not state
            
            if state then
                Tween(ToggleBack, {BackgroundColor3 = Colors.Success}, 0.2)
                Tween(ToggleKnob, {Position = UDim2.new(1, -20, 0.5, 0)}, 0.2)
            else
                Tween(ToggleBack, {BackgroundColor3 = Colors.Surface}, 0.2)
                Tween(ToggleKnob, {Position = UDim2.new(0, 2, 0.5, 0)}, 0.2)
            end
            
            if callback then pcall(function() callback(state) end) end
        end)
        
        local storedCallback = callback
        
        return {
            SetValue = function(val, triggerCallback)
                state = val
                ToggleBack.BackgroundColor3 = state and Colors.Success or Colors.Surface
                ToggleKnob.Position = state and UDim2.new(1, -20, 0.5, 0) or UDim2.new(0, 2, 0.5, 0)
                if triggerCallback and storedCallback then 
                    pcall(function() storedCallback(state) end) 
                end
            end,
            GetValue = function() return state end,
            TriggerCallback = function()
                if storedCallback then
                    pcall(function() storedCallback(state) end)
                end
            end
        }
    end
    
    local function CreateSlider(parent, text, min, max, default, callback)
        local Container = Instance.new("Frame")
        Container.Size = UDim2.new(1, 0, 0, 55)
        Container.BackgroundColor3 = Colors.Elevated
        Container.BorderSizePixel = 0
        Container.Parent = parent
        Corner(Container, 8)
        
        local Label = Instance.new("TextLabel")
        Label.Size = UDim2.new(1, -60, 0, 20)
        Label.Position = UDim2.new(0, 12, 0, 6)
        Label.BackgroundTransparency = 1
        Label.Font = Enum.Font.Gotham
        Label.Text = text
        Label.TextColor3 = Colors.TextPrimary
        Label.TextSize = 13
        Label.TextXAlignment = Enum.TextXAlignment.Left
        Label.Parent = Container
        
        local ValueLabel = Instance.new("TextLabel")
        ValueLabel.Size = UDim2.new(0, 50, 0, 20)
        ValueLabel.Position = UDim2.new(1, -56, 0, 6)
        ValueLabel.BackgroundTransparency = 1
        ValueLabel.Font = Enum.Font.GothamBold
        ValueLabel.Text = tostring(default)
        ValueLabel.TextColor3 = Colors.Primary
        ValueLabel.TextSize = 13
        ValueLabel.TextXAlignment = Enum.TextXAlignment.Right
        ValueLabel.Parent = Container
        
        local Track = Instance.new("Frame")
        Track.Size = UDim2.new(1, -24, 0, 4)
        Track.Position = UDim2.new(0, 12, 1, -16)
        Track.BackgroundColor3 = Colors.Surface
        Track.BorderSizePixel = 0
        Track.Parent = Container
        Corner(Track, 2)
        
        local Fill = Instance.new("Frame")
        Fill.Size = UDim2.new((default - min) / (max - min), 0, 1, 0)
        Fill.BackgroundColor3 = Colors.Primary
        Fill.BorderSizePixel = 0
        Fill.Parent = Track
        Corner(Fill, 2)
        
        local Knob = Instance.new("Frame")
        Knob.Size = UDim2.new(0, 16, 0, 16)
        Knob.Position = UDim2.new((default - min) / (max - min), 0, 0.5, 0)
        Knob.AnchorPoint = Vector2.new(0.5, 0.5)
        Knob.BackgroundColor3 = Colors.TextPrimary
        Knob.BorderSizePixel = 0
        Knob.Parent = Track
        Corner(Knob, 8)
        
        local dragging = false
        local currentValue = default
        
        local function Update(input)
            local pos = math.clamp((input.Position.X - Track.AbsolutePosition.X) / Track.AbsoluteSize.X, 0, 1)
            currentValue = math.floor(min + (pos * (max - min)))
            
            ValueLabel.Text = tostring(currentValue)
            Fill.Size = UDim2.new(pos, 0, 1, 0)
            Knob.Position = UDim2.new(pos, 0, 0.5, 0)
            
            if callback then pcall(function() callback(currentValue) end) end
        end
        
        local function StartDragging(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 then
                dragging = true
                Update(input)
            end
        end
        
        Track.InputBegan:Connect(StartDragging)
        Knob.InputBegan:Connect(StartDragging)
        
        UserInputService.InputEnded:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 then
                dragging = false
            end
        end)
        
        UserInputService.InputChanged:Connect(function(input)
            if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
                Update(input)
            end
        end)
        
        local storedCallback = callback
        
        return {
            SetValue = function(val, triggerCallback)
                currentValue = math.floor(math.clamp(val, min, max))
                local pos = (currentValue - min) / (max - min)
                ValueLabel.Text = tostring(currentValue)
                Fill.Size = UDim2.new(pos, 0, 1, 0)
                Knob.Position = UDim2.new(pos, 0, 0.5, 0)
                if triggerCallback and storedCallback then 
                    pcall(function() storedCallback(currentValue) end) 
                end
            end,
            GetValue = function() return currentValue end,
            TriggerCallback = function()
                if storedCallback then
                    pcall(function() storedCallback(currentValue) end)
                end
            end
        }
    end
    
    local function CreateLabel(parent, text)
        local Label = Instance.new("TextLabel")
        Label.Size = UDim2.new(1, 0, 0, 32)
        Label.BackgroundColor3 = Colors.Elevated
        Label.BorderSizePixel = 0
        Label.Font = Enum.Font.GothamBold
        Label.Text = text
        Label.TextColor3 = Colors.TextPrimary
        Label.TextSize = 13
        Label.TextXAlignment = Enum.TextXAlignment.Left
        Label.Parent = parent
        Corner(Label, 8)
        
        local LabelPad = Instance.new("UIPadding")
        LabelPad.PaddingLeft = UDim.new(0, 12)
        LabelPad.Parent = Label
        
        return {SetText = function(txt) Label.Text = txt end}
    end
    
    local function CreateTextbox(parent, placeholder, callback)
        local Container = Instance.new("Frame")
        Container.Size = UDim2.new(1, 0, 0, 38)
        Container.BackgroundColor3 = Colors.Elevated
        Container.BorderSizePixel = 0
        Container.Parent = parent
        Corner(Container, 8)
        
        local Textbox = Instance.new("TextBox")
        Textbox.Size = UDim2.new(1, -24, 1, 0)
        Textbox.Position = UDim2.new(0, 12, 0, 0)
        Textbox.BackgroundTransparency = 1
        Textbox.Font = Enum.Font.Gotham
        Textbox.PlaceholderText = placeholder
        Textbox.PlaceholderColor3 = Colors.TextSecondary
        Textbox.Text = ""
        Textbox.TextColor3 = Colors.TextPrimary
        Textbox.TextSize = 13
        Textbox.TextXAlignment = Enum.TextXAlignment.Left
        Textbox.ClearTextOnFocus = false
        Textbox.Parent = Container
        
        Textbox.FocusLost:Connect(function(enterPressed)
            if enterPressed and callback then
                pcall(function() callback(Textbox.Text) end)
            end
        end)
        
        return {
            GetText = function() return Textbox.Text end,
            SetText = function(txt) Textbox.Text = txt end,
            Clear = function() Textbox.Text = "" end
        }
    end
    
    local function CreateKeybind(parent, text, default, callback)
        local Container = Instance.new("Frame")
        Container.Size = UDim2.new(1, 0, 0, 38)
        Container.BackgroundColor3 = Colors.Elevated
        Container.BorderSizePixel = 0
        Container.Parent = parent
        Corner(Container, 8)
        
        local Label = Instance.new("TextLabel")
        Label.Size = UDim2.new(1, -100, 1, 0)
        Label.Position = UDim2.new(0, 12, 0, 0)
        Label.BackgroundTransparency = 1
        Label.Font = Enum.Font.Gotham
        Label.Text = text
        Label.TextColor3 = Colors.TextPrimary
        Label.TextSize = 13
        Label.TextXAlignment = Enum.TextXAlignment.Left
        Label.Parent = Container
        
        local KeyButton = Instance.new("TextButton")
        KeyButton.Size = UDim2.new(0, 85, 0, 28)
        KeyButton.Position = UDim2.new(1, -92, 0.5, 0)
        KeyButton.AnchorPoint = Vector2.new(0, 0.5)
        KeyButton.BackgroundColor3 = Colors.Surface
        KeyButton.BorderSizePixel = 0
        KeyButton.Font = Enum.Font.GothamBold
        KeyButton.Text = default or "None"
        KeyButton.TextColor3 = Colors.Primary
        KeyButton.TextSize = 12
        KeyButton.Parent = Container
        Corner(KeyButton, 6)
        
        local listening = false
        local currentKey = default
        
        KeyButton.MouseButton1Click:Connect(function()
            if not listening then
                listening = true
                KeyButton.Text = "..."
                
                local connection
                connection = UserInputService.InputBegan:Connect(function(input)
                    if input.UserInputType == Enum.UserInputType.Keyboard then
                        local key = input.KeyCode.Name
                        currentKey = key
                        KeyButton.Text = key
                        listening = false
                        connection:Disconnect()
                        
                        if callback then pcall(function() callback(key) end) end
                    end
                end)
            end
        end)
        
        local storedCallback = callback
        
        return {
            GetKey = function() return currentKey end,
            SetKey = function(key, triggerCallback) 
                currentKey = key 
                KeyButton.Text = key 
                if triggerCallback and storedCallback then
                    pcall(function() storedCallback(key) end)
                end
            end,
            TriggerCallback = function()
                if storedCallback then
                    pcall(function() storedCallback(currentKey) end)
                end
            end
        }
    end
    
    -- Create Tab function
    function Window:CreateTab(name, icon)
        local Tab = {}
        
        local TabButton = Instance.new("TextButton")
        TabButton.Name = name
        TabButton.Size = UDim2.new(1, -16, 0, 38)
        TabButton.BackgroundColor3 = Colors.Elevated
        TabButton.BackgroundTransparency = 0.5
        TabButton.BorderSizePixel = 0
        TabButton.Font = Enum.Font.Gotham
        TabButton.Text = (icon or "üìÅ") .. " " .. name
        TabButton.TextColor3 = Colors.TextSecondary
        TabButton.TextSize = 13
        TabButton.TextXAlignment = Enum.TextXAlignment.Left
        TabButton.AutoButtonColor = false
        TabButton.LayoutOrder = #Window.Tabs -- Ensures tabs appear in order created
        TabButton.Parent = Sidebar
        Corner(TabButton, 8)
        
        local TabPad = Instance.new("UIPadding")
        TabPad.PaddingLeft = UDim.new(0, 12)
        TabPad.Parent = TabButton
        
        local TabContent = Instance.new("ScrollingFrame")
        TabContent.Name = name .. "Content"
        TabContent.Size = UDim2.new(1, 0, 1, 0)
        TabContent.BackgroundTransparency = 1
        TabContent.BorderSizePixel = 0
        TabContent.ScrollBarThickness = 4
        TabContent.ScrollBarImageColor3 = Colors.Primary
        TabContent.CanvasSize = UDim2.new(0, 0, 0, 0)
        TabContent.Visible = false
        TabContent.Parent = ContentArea
        
        local ContentList = Instance.new("UIListLayout")
        ContentList.Padding = UDim.new(0, 10)
        ContentList.SortOrder = Enum.SortOrder.LayoutOrder
        ContentList.Parent = TabContent
        
        local ContentPad = Instance.new("UIPadding")
        ContentPad.PaddingTop = UDim.new(0, 8)
        ContentPad.PaddingLeft = UDim.new(0, 8)
        ContentPad.PaddingRight = UDim.new(0, 12)
        ContentPad.PaddingBottom = UDim.new(0, 8)
        ContentPad.Parent = TabContent
        
        ContentList:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
            TabContent.CanvasSize = UDim2.new(0, 0, 0, ContentList.AbsoluteContentSize.Y + 16)
        end)
        
        TabButton.MouseButton1Click:Connect(function()
            for _, tab in pairs(Window.Tabs) do
                Tween(tab.Button, {BackgroundTransparency = 0.5, TextColor3 = Colors.TextSecondary}, 0.2)
                tab.Content.Visible = false
            end
            
            Tween(TabButton, {BackgroundTransparency = 0, TextColor3 = Colors.TextPrimary}, 0.2)
            TabContent.Visible = true
            CurrentTab = Tab
        end)
        
        Tab.Button = TabButton
        Tab.Content = TabContent
        table.insert(Window.Tabs, Tab)
        
        -- Auto-select first tab (but not if it's the Config tab)
        if #Window.Tabs == 1 and TabButton.LayoutOrder < 900 then
            TabButton.BackgroundTransparency = 0
            TabButton.TextColor3 = Colors.TextPrimary
            TabContent.Visible = true
            CurrentTab = Tab
        end
        
        -- Tab element functions
        function Tab:AddButton(text, callback)
            return CreateButton(TabContent, text, callback)
        end
        
        function Tab:AddToggle(text, default, callback)
            local toggle = CreateToggle(TabContent, text, default, callback)
            Window.ConfigValues[text] = toggle
            return toggle
        end
        
        function Tab:AddSlider(text, min, max, default, callback)
            local slider = CreateSlider(TabContent, text, min, max, default, callback)
            Window.ConfigValues[text] = slider
            return slider
        end
        
        function Tab:AddLabel(text)
            return CreateLabel(TabContent, text)
        end
        
        function Tab:AddTextbox(placeholder, callback)
            return CreateTextbox(TabContent, placeholder, callback)
        end
        
        function Tab:AddKeybind(text, default, callback)
            local keybind = CreateKeybind(TabContent, text, default, callback)
            Window.ConfigValues[text] = keybind
            return keybind
        end
        
        return Tab
    end
    
    -- Function to create config tab (called at the end)
    function Window:InitializeConfigTab()
        -- Config Management Tab (Auto-added) - Always appears at bottom
        local ConfigTab = Window:CreateTab("Config", "‚öô")
        ConfigTab.Button.LayoutOrder = 999 -- Ensures Config tab is always last
        
        ConfigTab:AddLabel("Configuration Manager")
        
        local configNameBox = ConfigTab:AddTextbox("Enter config name...", nil)
        
        -- Config list container
        local ConfigListContainer = Instance.new("Frame")
        ConfigListContainer.Size = UDim2.new(1, 0, 0, 200)
        ConfigListContainer.BackgroundColor3 = Colors.Surface
        ConfigListContainer.BorderSizePixel = 0
        ConfigListContainer.Parent = ConfigTab.Content
        Corner(ConfigListContainer, 8)
        
        local ConfigScroll = Instance.new("ScrollingFrame")
        ConfigScroll.Size = UDim2.new(1, -8, 1, -8)
        ConfigScroll.Position = UDim2.new(0, 4, 0, 4)
        ConfigScroll.BackgroundTransparency = 1
        ConfigScroll.BorderSizePixel = 0
        ConfigScroll.ScrollBarThickness = 4
        ConfigScroll.ScrollBarImageColor3 = Colors.Primary
        ConfigScroll.CanvasSize = UDim2.new(0, 0, 0, 0)
        ConfigScroll.Parent = ConfigListContainer
        
        local ConfigList = Instance.new("UIListLayout")
        ConfigList.Padding = UDim.new(0, 4)
        ConfigList.SortOrder = Enum.SortOrder.LayoutOrder
        ConfigList.Parent = ConfigScroll
        
        local ConfigPad = Instance.new("UIPadding")
        ConfigPad.PaddingTop = UDim.new(0, 4)
        ConfigPad.PaddingLeft = UDim.new(0, 4)
        ConfigPad.PaddingRight = UDim.new(0, 4)
        ConfigPad.PaddingBottom = UDim.new(0, 4)
        ConfigPad.Parent = ConfigScroll
        
        ConfigList:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
            ConfigScroll.CanvasSize = UDim2.new(0, 0, 0, ConfigList.AbsoluteContentSize.Y + 8)
        end)
        
        local SelectedConfig = nil
        
        local function UpdateConfigList()
            for _, child in pairs(ConfigScroll:GetChildren()) do
                if child:IsA("Frame") then child:Destroy() end
            end
            
            SavedConfigs = LoadSavedConfigs()
            
            for _, configName in pairs(SavedConfigs) do
                local ConfigItem = Instance.new("Frame")
                ConfigItem.Size = UDim2.new(1, 0, 0, 32)
                ConfigItem.BackgroundColor3 = Colors.Elevated
                ConfigItem.BorderSizePixel = 0
                ConfigItem.Parent = ConfigScroll
                Corner(ConfigItem, 6)
                
                local ConfigName = Instance.new("TextLabel")
                ConfigName.Size = UDim2.new(1, -80, 1, 0)
                ConfigName.Position = UDim2.new(0, 8, 0, 0)
                ConfigName.BackgroundTransparency = 1
                ConfigName.Font = Enum.Font.Gotham
                ConfigName.Text = configName
                ConfigName.TextColor3 = Colors.TextPrimary
                ConfigName.TextSize = 12
                ConfigName.TextXAlignment = Enum.TextXAlignment.Left
                ConfigName.Parent = ConfigItem
                
                local SelectBtn = Instance.new("TextButton")
                SelectBtn.Size = UDim2.new(0, 70, 0, 24)
                SelectBtn.Position = UDim2.new(1, -74, 0.5, 0)
                SelectBtn.AnchorPoint = Vector2.new(0, 0.5)
                SelectBtn.BackgroundColor3 = Colors.Primary
                SelectBtn.BorderSizePixel = 0
                SelectBtn.Font = Enum.Font.GothamBold
                SelectBtn.Text = "Select"
                SelectBtn.TextColor3 = Colors.TextPrimary
                SelectBtn.TextSize = 11
                SelectBtn.Parent = ConfigItem
                Corner(SelectBtn, 4)
                
                SelectBtn.MouseButton1Click:Connect(function()
                    SelectedConfig = configName
                    configNameBox.SetText(configName)
                    
                    for _, item in pairs(ConfigScroll:GetChildren()) do
                        if item:IsA("Frame") then
                            item.BackgroundColor3 = Colors.Elevated
                        end
                    end
                    
                    ConfigItem.BackgroundColor3 = Colors.Primary
                    
                    game.StarterGui:SetCore("SendNotification", {
                        Title = "D.R.X";
                        Text = "Selected: " .. configName;
                        Duration = 2;
                    })
                end)
            end
        end
        
        ConfigTab:AddButton("üíæ Save Config", function()
            local configName = configNameBox.GetText()
            print("Save clicked, config name:", configName)
            
            if configName == "" then
                game.StarterGui:SetCore("SendNotification", {
                    Title = "D.R.X";
                    Text = "Please enter a config name!";
                    Duration = 2;
                })
                return
            end
            
            local data = {}
            for key, element in pairs(Window.ConfigValues) do
                data[key] = element.GetValue()
                print("Saving", key, "=", data[key])
            end
            
            print("Attempting to save config:", configName)
            if SaveConfig(configName, data) then
                print("Save successful!")
                game.StarterGui:SetCore("SendNotification", {
                    Title = "D.R.X";
                    Text = "Config saved: " .. configName;
                    Duration = 2;
                })
                -- Update list asynchronously to avoid blocking
                task.spawn(function()
                    task.wait(0.1)
                    print("Updating config list...")
                    UpdateConfigList()
                end)
            else
                print("Save failed!")
                game.StarterGui:SetCore("SendNotification", {
                    Title = "D.R.X";
                    Text = "Failed to save config!";
                    Duration = 2;
                })
            end
        end)
        
        ConfigTab:AddButton("üìÇ Load Config", function()
            local configName = configNameBox.GetText()
            if configName == "" then
                game.StarterGui:SetCore("SendNotification", {
                    Title = "D.R.X";
                    Text = "Please select a config!";
                    Duration = 2;
                })
                return
            end
            
            local data = LoadConfig(configName)
            if data then
                -- Set all values without triggering callbacks
                for key, element in pairs(Window.ConfigValues) do
                    if data[key] ~= nil then
                        element.SetValue(data[key], false)
                    end
                end
                
                -- Wait a tiny bit then trigger all callbacks to apply settings
                task.wait(0.05)
                for key, element in pairs(Window.ConfigValues) do
                    if data[key] ~= nil and element.TriggerCallback then
                        element.TriggerCallback()
                    end
                end
                
                game.StarterGui:SetCore("SendNotification", {
                    Title = "D.R.X";
                    Text = "Config loaded: " .. configName;
                    Duration = 2;
                })
            else
                game.StarterGui:SetCore("SendNotification", {
                    Title = "D.R.X";
                    Text = "Failed to load config!";
                    Duration = 2;
                })
            end
        end)
        
        ConfigTab:AddButton("üóë Delete Config", function()
            local configName = configNameBox.GetText()
            if configName == "" then
                game.StarterGui:SetCore("SendNotification", {
                    Title = "D.R.X";
                    Text = "Please select a config!";
                    Duration = 2;
                })
                return
            end
            
            if DeleteConfig(configName) then
                configNameBox.Clear()
                SelectedConfig = nil
                game.StarterGui:SetCore("SendNotification", {
                    Title = "D.R.X";
                    Text = "Config deleted: " .. configName;
                    Duration = 2;
                })
                -- Update list asynchronously to avoid blocking
                task.spawn(function()
                    task.wait(0.05)
                    UpdateConfigList()
                end)
            else
                game.StarterGui:SetCore("SendNotification", {
                    Title = "D.R.X";
                    Text = "Failed to delete config!";
                    Duration = 2;
                })
            end
        end)
        
        ConfigTab:AddLabel("Keybinds")
        
        local toggleKey = ConfigTab:AddKeybind("Toggle GUI", "RightShift", nil)
        
        -- Load config list on startup
        UpdateConfigList()
        
        -- Now select the FIRST user tab (not Config)
        task.wait(0.05)
        if Window.Tabs[1] and Window.Tabs[1].Button.LayoutOrder < 900 then
            local firstTab = Window.Tabs[1]
            firstTab.Button.BackgroundTransparency = 0
            firstTab.Button.TextColor3 = Colors.TextPrimary
            firstTab.Content.Visible = true
            for _, tab in pairs(Window.Tabs) do
                if tab ~= firstTab then
                    tab.Content.Visible = false
                end
            end
        end
        
        Window.ToggleKey = toggleKey
    end
    
    -- Dragging
    local dragging = false
    local dragInput, dragStart, startPos
    
    TopBar.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
            dragStart = input.Position
            startPos = Main.Position
            
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)
    
    UserInputService.InputChanged:Connect(function(input)
        if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
            local delta = input.Position - dragStart
            Main.Position = UDim2.new(
                startPos.X.Scale,
                startPos.X.Offset + delta.X,
                startPos.Y.Scale,
                startPos.Y.Offset + delta.Y
            )
        end
    end)
    
    -- Toggle keybind
    UserInputService.InputBegan:Connect(function(input, gameProcessed)
        if not gameProcessed then
            -- Wait until InitializeConfigTab is called
            task.spawn(function()
                while not Window.ToggleKey do task.wait() end
                if input.KeyCode.Name == Window.ToggleKey.GetKey() then
                    Main.Visible = not Main.Visible
                end
            end)
        end
    end)
    
    -- Entrance animation
    Main.BackgroundTransparency = 1
    TopBar.BackgroundTransparency = 1
    Sidebar.BackgroundTransparency = 1
    
    for _, child in pairs(Main:GetDescendants()) do
        if child:IsA("TextLabel") or child:IsA("TextButton") then
            child.TextTransparency = 1
        end
    end
    
    Tween(Main, {BackgroundTransparency = 0}, 0.3)
    Tween(TopBar, {BackgroundTransparency = 0}, 0.3)
    Tween(Sidebar, {BackgroundTransparency = 0}, 0.3)
    
    wait(0.1)
    
    for _, child in pairs(Main:GetDescendants()) do
        if child:IsA("TextLabel") or child:IsA("TextButton") then
            Tween(child, {TextTransparency = 0}, 0.3)
        end
    end
    
    Window.Main = Main
    
    return Window
end

return Library
